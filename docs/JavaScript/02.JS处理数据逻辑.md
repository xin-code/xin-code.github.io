---
title: JS处理数据逻辑
date: 2022-03-24 10:21:02
sticky: false
permalink: /pages/dcd28e/
categories: 
  - JavaScript
tags: 
  - JavaScript
author: 
  name: Xin
  link: https://github.com/xin-code
---

此文档总结整理在工作中出现的部分JavaScript常见的处理逻辑

<!-- more -->



## 改变数组中value、key值

```javascript
let arr = [
	{mz:'张三',"nl":20},
	{mz:'李四',"nl":18},
	{mz:'王五',"nl":33},
]
const newArr = arr.map((item)=>{
    return {
    	name:item.mz,
    	age:item.nl,
	}
})

console.log(newArr)
[
    {
        "name": "张三",
        "age": 20
    },
    {
        "name": "李四",
        "age": 18
    },
    {
        "name": "王五",
        "age": 33
    }
]
```



## 对象变数组

```javascript
let data = {
    '张三':{age:10,sex:'男'},
    '李四':{age:12,sex:'女'}
}

let Array = Object.keys(data).map(key => {
    return {
        name:key,
        ...data[key]
    }
})

console.log(Array)
// 变为下列的数组
[
    {
        "name": "张三",
        "age": 10,
        "sex": "男"
    },
    {
        "name": "李四",
        "age": 12,
        "sex": "女"
    }
]
```





## 定时器

- SetTimeOut()

  ```javascript
  // 定时器
  setTimeout(() => {
  	this.方法名()
  }, 200)
  
  ```




## 日期

1. 获取当前时间是年内第几周

```javascript
/**
 *获取某年某月某天是第几周
 *第一天为周日
 */
getWeekNumber(y, m, d) {
    var targetDay = new Date(y, m - 1, d);
    var year = targetDay.getFullYear();
    var month = targetDay.getMonth();
    var days = targetDay.getDate();
    //那一天是那一年中的第多少天
    for (var i = 1; i < m; i++) {
        days += this.getMonthDays(year, i);
    }
    //那一年第一天是星期几
    var yearFirstDay = new Date(year, 0, 1).getDay();
    //计算是第几周
    days += yearFirstDay;
    var week = Math.ceil(days / 7);
    return week;
}
 
/**
 *判断年份是否为润年
 */
isLeapYear(year) {
    return (year % 400 == 0) || (year % 4 == 0 && year % 100 != 0);
}
/**
 *获取某年某月的天数
 */
getMonthDays(year, month) {
    return [31, (this.isLeapYear(year) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month - 1];
}
```

2. 去除日月前的0

```javascript
// 去除0 参数 日期 如 2020-07-08 返回为 2020-7-8
dislodgeZero(str) {
	let strArray = str.split("-");
	strArray = strArray.map((val)=> {
		if (val[0] == "0") {
			return (val = val.slice(1));
		} else {
			return val;
		}
	});
      return strArray.join("-");
}
```

3. 将时间戳转化为转为本地时间(去除TZ)

```
// inputTime 为 13 位（毫秒级）
function formatTimeStamp(inputTime){
	if(!inputTime && typeof inputTime !== 'number'){
		return '';
	}
	var localTime = '';
	inputTime = new Date(inputTime).getTime();
	const offset = (new Date()).getTimezoneOffset();
	localTime = (new Date(inputTime - offset * 60000)).toISOString();
	localTime = localTime.substr(0, localTime.lastIndexOf('.'));
	localTime = localTime.replace('T', ' ');
	return localTime;
}
```

4. 时间戳转为`yyyy-MM-DD HH:mm:ss`

```javascript
function formatDateTime (inputTime) {
  var date = new Date(inputTime)
  var y = date.getFullYear()
  var m = date.getMonth() + 1
  m = m < 10 ? ('0' + m) : m
  var d = date.getDate()
  d = d < 10 ? ('0' + d) : d
  var h = date.getHours()
  h = h < 10 ? ('0' + h) : h
  var minute = date.getMinutes()
  var second = date.getSeconds()
  minute = minute < 10 ? ('0' + minute) : minute
  second = second < 10 ? ('0' + second) : second
  return y + '-' + m + '-' + d + ' ' + h + ':' + minute + ':' + second
}
```

