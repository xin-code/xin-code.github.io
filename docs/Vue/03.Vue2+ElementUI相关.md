---
title: Vue2+ElementUI相关
date: 2022-10-12 14:00:21
categories:
  - Vue2
tags:
  - null
permalink: /pages/985391/
author:
  name: Xin
  link: https://github.com/xin-code
---

Vue2 与 Element-UI 在工作中遇到的问题

<!-- more -->



## el-dialog 与外层均可操作

- :modal="false" 是否需要遮罩层

- :close-on-click-modal="false" 是否可以通过点击 modal 关闭 Dialog

- :star: 在 CSS 中添加如下样式

  ```css
  // 覆盖层元素增加可穿透点击事件
  .el-dialog__wrapper {
    pointer-events: none;
  }
  // 弹窗层元素不可穿透点击事件（不影响弹窗层元素的点击事件）
  .el-dialog {
    pointer-events: auto;
  }
  ```



## el-table去除表头全选框

```vue
<el-table
	:data="tableData"
	:header-cell-class-name="cellClass"
>
</el-table>

// methods 方法 
cellClass(row) {
	if (row.columnIndex === 0) {
		return 'disabledCheck';
	}
},

// css
::v-deep .disabledCheck .el-checkbox {
  display: none;
}
```



## el-table快速居中

```vue
<template>
  <el-table
    :data="tableData
    :cell-style="{ textAlign: 'center' }"
    :header-cell-style="{ textAlign: 'center' }"
  >
    <el-table-column prop="date" label="日期"> </el-table-column>
  </el-table>
</template>

<script>
export default {
  name: 'TableTree',
  data() {
    return {
      tableData: [],
    };
  },
};
</script>

<style lang="scss" scoped></style>
```





## el-table 筛选关键字，并标红

> 需求: 根据筛选项的 `关键字` 在 el-table 中标记颜色

![el-table筛选项.png](https://s2.loli.net/2022/11/23/pQEec9jWHuvTL5R.png)

```vue
<el-table :data="tableData" style="width: 100%">
    <el-table-column prop="address" label="地址">
        <template slot-scope="scope">
			<span v-html="showDate(scope.row.address)"></span>
        </template>
    </el-table-column>
</el-table>

// methods 方法 
// this.keyWorld 是指的搜索的关键词 
showDate(val) { 
	if(val.indexOf(this.keyWorld) !== -1 && this.keyWorld !== '') { 
		return val.replace( this.keyWorld, '<font color="#f00">' + this.keyWorld + '</font>' ); 
	} else { 
		return val; 
	} 
}


// 多个关键字标红
markKeyWord(cellText) {
  // 1.传入关键词数组keyWordArr
  let keyWordArr = ["王","0"];
  // 2.定制关键词对应正则
  let regStr = '';
  keyWordArr.map((val,idx)=>{
    if(idx !== keyWordArr.length -1 ){
      regStr += `(${val})|`;
    }else{
      regStr += `(${val})`;
    }
  })
  let reg = new RegExp(regStr,"g");
  // 3.正则替换，关键词飘红
  let str = cellText.replace(reg, function($0,$1) {
    return  `<span style="color:red;">${$0}</span>`;
  });
  return str;
}

```





## el-table 前端分页

1. :data = "tableData.slice((currentPage - 1) * pageSize, currentPage * pageSize)"
2. 分页修改data值

```vue
<template>
  <div>
    <div class="paging">
      <!--数据显示区域-->
      <div class="data">
        <!--表格存放数组中的数据，并对数据进行截取，以控制每一页显示的数据量-->
        <!--slice(start,end) 不包括end-->
        <el-table :data="tableData.slice((currentPage - 1) * pageSize, currentPage * pageSize)" stripe
                  style="width: 100%">
          <el-table-column prop="date" label="日期" width="220" align="center"></el-table-column>
          <el-table-column prop="name" label="姓名" width="220" align="center"></el-table-column>
          <el-table-column prop="job" label="职业" width="220" align="center"></el-table-column>
          <el-table-column prop="address" label="地址" align="center"></el-table-column>
        </el-table>
      </div>
      <!--分页按钮-->
      <el-pagination
              background
              layout="prev, pager, next,jumper, ->, total"
              :total="tableData.length"
              @current-change="handleCurrentChange"
              :current-page="currentPage"
              :page-size="pageSize"
              style="text-align: center">
      </el-pagination>
    </div>
  </div>
</template>
 
<script>
  export default {
    name: "fenye.vue",
    data() {
      return {
        currentPage: '1', //当前页 刷新后默认显示第一页
        pageSize: '6', //每一页显示的数据量 此处每页显示6条数据
        //假数据
        tableData: [
          {
            date: '2016-05-02',
            name: '橘右京',
            job: '刺客',
            address: '上海市普陀区金沙江路 1518'
          },
        ],
      }
    },
    methods: {
      //点击按钮切换页面
      handleCurrentChange(currentPage) {
        this.currentPage = currentPage; //每次点击分页按钮，当前页发生变化
        // console.log(this.currentPage);
      },
    },
    mounted() {
 
    }
  }
</script>
 
<style scoped>
  .paging {
    width: 1000px;
    height: 500px;
    margin: 100px auto;
  }
 
  .data {
    width: 98%;
    height: 340px;
    border: 2px solid #cccccc;
    margin: 10px auto;
    text-align: center;
  }
</style>
```







## Form表单单独控制红框

![form表单控制红色border.png](https://s2.loli.net/2023/02/01/OVrMgUm87GQH4oh.png)

```vue
 <el-form-item label="生日" class="is-error is-required">
</el-form-item>

// 只需要添加css即可
// is-error 为border变红
// is-required 为*
```





## el-input 回车刷新页面

产生原因：当输入input内容后，按下回车，会刷新页面。这是因为el-form中只有一个el-input的时候，自动触发页面上的提交功能，产生刷新页面

解决办法：

- el-form中多加一个`el-form-item`

  ```vue
  <el-form :model="form" ref="formRef" :inline="true" >
    <el-form-item label="姓名" prop="name" >
      <el-input v-model="form.name" placeholder="请输入品名" @keydown.enter="handleQuery" />
    </el-form-item>
    // form表单内多增加一个元素，不占据位置即可
    <div></div>
  </el-form>
  ```

- el-form 加 `@submit.native.prevent` 阻止绑定事件

  @submit: 表单提交
  .native 绑定系统原生事件
  .prevent 提交以后不刷新页面

  ```vue
  // 在 el-form 中 加个 @submit.native.prevent
  <el-form :model="form" ref="formRef" :inline="true" @submit.native.prevent>
    <el-form-item label="姓名" prop="name" >
      <el-input v-model="form.name" placeholder="请输入品名" @keyup.enter.native="handleQuery" />
    </el-form-item>
  </el-form>
  ```

  





## el-table 左右鼠标拖动

- 创建鼠标左右滑动效果的组件

  创建文件`tableMove.js`

```js
import Vue from 'vue'

const tablesMove = function (Vue) {
  // 全局添加table左右拖动效果的指令
  Vue.directive('tableMove', {
    bind: function (el, binding, vnode) {
      var odiv = el // 获取当前表格元素

      // 修改样式小手标志
      // el.style.cursor = 'pointer'
      el.querySelector('.el-table .el-table__body-wrapper').style.cursor = 'pointer'

      var mouseDownAndUpTimer = null
      var mouseOffset = 0
      var mouseFlag = false

      let bindRef = binding.value[0] //绑定的表格的ref属性


      odiv.onmousedown = (e) => {
        const ePath = composedPath(e)
        // 拖拽表头不滑动
        if (ePath.some(res => {
          return res && res.className && res.className.indexOf('el-table__header') > -1
        })) return

        if (e.which !== 1) return

        mouseOffset = e.clientX
        mouseDownAndUpTimer = setTimeout(function () {
          mouseFlag = true
        }, 80)
      }

      odiv.onmouseup = (e) => {
        setTimeout(() => {
          // 解决拖动列宽行不对齐问题--渲染表格
          if (!vnode.context.$refs[bindRef]) return
          vnode.context.$refs[bindRef].doLayout()
        }, 200)
        if (mouseFlag) {
          mouseFlag = false
        } else {
          clearTimeout(mouseDownAndUpTimer) // 清除延迟时间
        }
      }

      odiv.onmouseleave = (e) => {
        setTimeout(() => {
          // 解决拖动列宽行不对齐问题--渲染表格
          if (!vnode.context.$refs[bindRef]) return
          vnode.context.$refs[bindRef].doLayout()
        }, 200)
        mouseFlag = false
      }

      odiv.onmousemove = (e) => {
        if (e.which !== 1) return

        const divData = odiv.querySelector('.el-table .el-table__body-wrapper')
        if (mouseFlag && divData) {
          // 设置水平方向的元素的位置
          divData.scrollLeft -= (-mouseOffset + (mouseOffset = e.clientX))
        }
      }

      // 解决有些时候,在鼠标松开的时候,元素仍然可以拖动;
      odiv.ondragstart = (e) => {
        e.preventDefault()
      }

      odiv.ondragend = (e) => {
        e.preventDefault()
      }

      // 点击复制文本
      // odiv.onclick = (e) => {
      //   setTimeout(() => {
      //     if (mouseFlag) return
      //     if (e.target.nodeName === 'SPAN') {
      //       console.log(mouseFlag, e.target.nodeName, this)
      //       var aux = document.createElement('input')
      //       aux.setAttribute('value', e.target.outerText)
      //       document.body.appendChild(aux)
      //       aux.select()
      //       document.execCommand('copy')
      //       document.body.removeChild(aux)
      //       if (document.execCommand('copy')) {
      //         console.log('复制成功')
      //       } else {
      //         console.log('复制失败')
      //       }
      //     }
      //   }, 300)
      // }

      // 是否拖拽可选中文字
      odiv.onselectstart = () => {
        return false
      }

      //浏览器Event.path属性不存在
      function composedPath (e) {
        // 存在则直接return
        if (e.path) {
          return e.path
        }
        // 不存在则遍历target节点
        let target = e.target
        e.path = []
        while (target.parentNode !== null) {
          e.path.push(target)
          target = target.parentNode
        }
        // 最后补上document和window
        e.path.push(document, window)
        return e.path
      }
    }
  })
}


export default tablesMove
```



- 在main.js中注册该组件

```javascript
import tableMove from "@/utils/tableMove.js" // el-table左右拖拽

Vue.use(tableMove)
```



- 使用该组件

```vue
<el-table :data="tableData"
          ref="fmeaTableRef"
          :span-method="objectSpanMethod"
          style="width: 100%"
          v-table-move="['fmeaTableRef']"
          border>
     <el-table-column/>
</el-table>
```



